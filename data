import requests
from bs4 import BeautifulSoup
import pandas as pd
import os

url = 'https://www.basketball-reference.com/leagues/NBA_2021_per_game.html'
page = requests.get(url)
page
page.content
soup = BeautifulSoup(page.content, 'html.parser')
print(soup.prettify())

table = soup.find_all(class_="full_table")
table
head = soup.find(class_='thead')


column_names_raw=[head.text for item in head][0]
column_names_raw
column_names_clean = column_names_raw.replace("\n",",").split(",")[2:-1]
column_names_clean


players = []

for i in range (len(table)):
    player_ = []
    
    for td in table[i].find_all("td"):
        player_.append(td.text)
    players.append(player_)

df = pd.DataFrame(players, columns = column_names_clean).set_index('Player')
df
