import sys
import os
import codecs
import shutil
import requests
years = list(range(2016,2022))
months = ['october','november','december','january','february','march','april']
url_start ='https://www.basketball-reference.com/leagues/NBA_{}_games-{}.html'

#Loops through the years variable and months variable opens the weblink and writes to an html file.

for year in years:
    for month in months:
        url = url_start.format(year,month)
    
    
        data = requests.get(url)
    
        with open("scheduleandresults/{} {}.html".format(year,month), "w+",encoding="utf-8") as f:
            f.write(data.text)
from bs4 import BeautifulSoup
import pandas as pd



#Actually extracts the data from the html files. Using the HTML ID. Loops through for all years.
dfs = []
for year in years:
    
    for month in months:
        
        
        with open("scheduleandresults/{} {}.html".format(year,month), encoding= "utf-8") as f:
            
            page = f.read()
    
        soup = BeautifulSoup(page, 'html.parser')
        scheduleandresults_data_table = soup.find_all(id="schedule")[0]
        scheduleandresults_df = pd.read_html(str( scheduleandresults_data_table))[0]
         
            
        scheduleandresults_df["Year"] = year
        scheduleandresults_df["Month"] = month
    

    
    
    
        dfs.append(scheduleandresults_df)

scheduleandresults_df=pd.concat(dfs)
